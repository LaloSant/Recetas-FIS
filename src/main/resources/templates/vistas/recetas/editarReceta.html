<!DOCTYPE html>
<html lang="es" xmlns:th="https://www.thymeleaf.org">

<head th:replace="~{template :: head}"></head>

<body class="bg-secondary">
	<header th:replace="~{template :: header (${nomUser})}"></header>

	<div class="container p-4">
		<div class="row">
			<div class="container justify-content-center card m-3">
				<h1 class="text-center">Editar receta</h1>
				<div class="card-body">
					<form th:action="@{/recetas/editar}" th:object="${dto}" method="post">
						<div class="mb-1 mt-3">
							<div class="input-group">
								<span class="input-group-text"><i class="bi bi-hash"></i></span>
								<span class="input-group-text" th:text="'ID RECETA'"></span>
								<input class="form-control bg-light" th:field="*{receta.idReceta}" th:value="${dto.receta.idReceta}" type="text"
									readonly>
								<span class="input-group-text"><i class="bi bi-star-half"></i></span>
								<span class="input-group-text" th:text="'CALIFICACION (X/5)'"></span>
								<span class="input-group-text" th:text="${dto.receta.calificacion}"></span>
								<input hidden th:field="*{receta.calificacion}" th:value="${dto.receta.calificacion}" type="text">
								<input hidden th:field="*{receta.visitasTotales}" th:value="${dto.receta.visitasTotales}" readonly>
								<input hidden th:field="*{receta.visitasSemanales}" th:value="${dto.receta.visitasSemanales}" readonly>
							</div>
							<div class="input-group my-3">
								<span class="input-group-text"><i class="bi bi-file-text"></i></span>
								<span class="input-group-text" th:text="'NOMBRE'"></span>
								<input class="form-control" th:field="*{receta.nombre}" th:value="${dto.receta.nombre}" type="text">
							</div>
							<div class="input-group mt-2">
								<span class="input-group-text"><i class="bi bi-person-circle"></i></span>
								<span class="input-group-text" th:text="'USUARIO'"></span>
								<span class="input-group-text" th:text="*{receta.usuario.nombre}"></span>
							</div>
						</div>
						<div class="mb-1 mt-3">
							<div class="d-flex justify-content-center">
								<h4 class="text-center">PASOS:</h4>
							</div>
							<div th:each="paso, iterStat : *{pasos}" class="ms-5">
								<div class="mb-3 mt-1 ms-5">
									<div class="input-group">
										<span class="input-group-text"><i class="bi bi-chevron-right"></i></span>
										<span class="input-group-text" th:text="'Paso ' + ${paso.indicePaso}"></span>
										<input type="hidden" th:field="*{pasos[__${iterStat.index}__].idPaso}" />
										<input type="text" th:field="*{pasos[__${iterStat.index}__].notas}" class="form-control" />
									</div>
								</div>
							</div>
						</div>
						<div>
							<div class="d-flex justify-content-center mt-3">
								<h4 class="text-center">INGREDIENTES:</h4>
							</div>
							<div th:each="detalle, iterStat : *{detalles}" class="ms-5">
								<div class="mb-3 mt-1 ms-5">
									<div class="input-group">
										<span class="input-group-text"><i class="bi bi-chevron-right"></i></span>
										<span class="input-group-text">Detalle</span>
										<input type="hidden" th:field="*{detalles[__${iterStat.index}__].idDetalle}" />
										<input type="text" th:field="*{detalles[__${iterStat.index}__].cantidad}" class="form-control" />
										<select th:field="*{detalles[__${iterStat.index}__].ingrediente.idIngrediente}" class="form-select">
											<option value="">Seleccionar ingrediente</option>
											<option th:each="ingrediente : ${ingredientes}" th:value="${ingrediente.idIngrediente}"
												th:text="${ingrediente.nombre} + ' (' + ${ingrediente.magnitud} + ')'"
												th:selected="${ingrediente.idIngrediente == detalle.ingrediente.idIngrediente}">
											</option>
										</select>
										<span class="input-group-text" th:text="'Costo unitario: ' + ${detalle.costo}"></span>
										<input type="hidden" th:field="*{detalles[__${iterStat.index}__].costo}" />
									</div>
								</div>
							</div>
						</div>
						<div class="box-footer d-flex justify-content-center">
							<button class="btn btn-success btn-lg">Guardar Receta</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<footer th:replace="~{template :: footer}"></footer>
</body>

</html>